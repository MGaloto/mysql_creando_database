---
title: "Data Warehouse"
author: "Maximiliano Galoto"
subtitle: "Avances del Proyecto Final"
output:
 prettydoc::html_pretty:
    theme: lumen
    highlight: github
    toc: true
    toc_depth: 2
    math: katex



---




<br>
</br>


```{css my-header-colors, echo = FALSE}
.page-header {
    background-image: linear-gradient(200deg, black, blue);
    border: solid 1px black;
    border-radius: .3rem;
}


```




<style type="text/css">




.toc .toc-box {
    padding: 1.5rem;
    background-color: #f5f5f5;
    border: solid 1px #6b6b6b;
    border-radius: .3rem;
}

a {
    color: black;
    text-decoration: none;
}

.main-content h1, .main-content h2, .main-content h3, .main-content h4, .main-content h5, .main-content h6 {
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-weight: 400;
    color: black;
}



.main-content table th {
    font-weight: 700;
    background-image: linear-gradient(2000deg, black, blue);
    color: white;
}

.main-content table td{
    padding: .5rem 1rem;
    border-bottom: 1px solid #e9ebec;
    text-align: left;
    color: black;
}

.main-content table tr:nth-child(odd) {
    background-color: #fcfcfc;
}

.main-content table tr:nth-child(even) {
    background-color: #ffffff;
}


h1.title {
  font-size: 58px;
  color: white;
  text-align: center;
}
h3.subtitle { 
    font-size: 28px;
  font-family: "Times New Roman", Times, serif;
  color: white ;
  text-align: center;
}
h4.author { 
    font-size: 22px;
  font-family: "Times New Roman", Times, serif;
  color:white ;
  text-align: center;
}





</style>

<br>
</br>


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tinytex)


# app.diagrams.net

```


<div style="text-align: left" class="toc-box">
# 1 - Introduccion
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>


<b>

Un Data Warehouse es un almacén electrónico donde generalmente una empresa u organización mantiene una gran cantidad de información. Los datos de un data warehouse deben almacenarse de forma segura, fiable, fácil de recuperar y fácil de administrar.

```{r, echo=FALSE, out.width="80%", fig.align='center'}
knitr::include_graphics("Imagenes/datawarehouse.jpg")
```




El concepto de data warehouse se originó en 1988 con el trabajo de los investigadores de IBM, Barry Devlin y Paul Murphy aunque el término data warehouse fue acuñado por William H. Inmon, el cual es conocido como el padre de Data Warehousing. Inmon describió un data warehouse como una colección de datos orientada a un tema específico, integrado, variante en el tiempo y no volátil, que soporta el proceso de toma de decisiones.


</b>

<br>
</br>

<div style="text-align: left" class="toc-box">
# 2 - My Sql
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>

<br>
</br>

```{r, echo=FALSE, out.width="50%", fig.align='center'}
knitr::include_graphics("Imagenes/MySQL-logo.png")
```


<br>
</br>


<b>

Es un sistema de gestión de bases de datos relacional desarrollado bajo licencia dual: Licencia pública general/Licencia comercial por Oracle Corporation y está considerada como la base de datos de código abierto más popular del mundo, y una de las más populares en general junto a Oracle y Microsoft SQL Server, todo para entornos de desarrollo web.

A continuacion se encuentra un link con los instructivos para poder descargar e instalar My Sql:


[Guia de Instalacion de My Sql](https://docs.google.com/document/d/1GrStEE5YxDCRqYwWI0LASCCqiel2qooD/edit?usp=sharing&ouid=107665703043742500688&rtpof=true&sd=true)
</b>







<br>
</br>

<div style="text-align: left" class="toc-box">
# 3 - Descripcion del proyecto
</div>



<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>

<br>
</br>

 **_Temática para el trabajo final:_**



<b>
Base de datos de una _Empresa de Medicina Prepaga_ donde se va a hacer foco en un modelo de esquema [copo de nieve](https://es.wikipedia.org/wiki/Esquema_en_copo_de_nieve).
</b>


```{r, echo=FALSE, out.width="80%", fig.align='center'}
knitr::include_graphics("Imagenes/snowflake.png")
```





<br>
</br>

<div style="text-align: left" class="toc-box">
# 4 - Descripción de las tablas
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>

<br>
</br>

<b>
**_Tablas, descripción y atributos:_**

A continuación se detallaran cada una de las tablas que componen el DER con sus atributos y descripciones:

<br>
</br>




| $$ \textbf{Tabla: Afiliado }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Afiliado$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Nombre$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |
| $$ Apellido$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 
| $$ Email$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 
| $$ Telefono$$     | $$INT \:NOT \:NULL  $$         | 
| $$ Fecha\:Nacimiento$$     | $$DATE \:NOT \:NULL$$        | 
| $$ Domicilio$$     | $$VARCHAR(50) \:NOT \:NULL  $$            | 
| $$ Estado\:Civil$$     | $$VARCHAR(50) \:NOT \:NULL  $$            | 
| $$ Dni$$     | $$INT \:NOT \:NULL  $$            | 
| $$ Id\:Ocupacion$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Plan$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 

_Esta tabla contiene los atributos de los afiliados de la empresa de medicina prepaga, podemos observar el ID como Primary Key y por ultimo dos FK que hacen referencia a la ocupación del empleado y el plan. Estas serán dos tablas que se crean a parte para no repertir datos._


_Un ejemplo sencillo: La ocupación puede ser empleado bajo relación de dependencia, monotributista, desempleado o jubilado. Estos datos se pondrán aparte en una tabla llamada *ocupacion_afiliado* y en la tabla *afiliado* solo de pondrá el numero de ID ya que al ir dando de alta a los afiliados en el sistema nos ahorrariamos espacio en la base de datos al no tener que repetir tantos caracteres por fila y solamente completar con el ID de ocupacion que viene de la tabla *ocupacion_afiliado*._



<br>
</br>


| $$ \textbf{Tabla: Ocupacion Afiliado }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Ocupacion$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Ocupacion$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 


_Esta tabla contiene los siguientes datos: *Bajo relacion de dependencia, monotributista, desempleado y jubilado*._

<br>
</br>


| $$ \textbf{Tabla: Plan Afiliado }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Plan$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Nombre$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 


_Esta tabla contiene los siguientes datos: *Medium y Premium*._

<br>
</br>


  

| $$ \textbf{Tabla: Medico }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Medico$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Nombre$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |
| $$ Apellido$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 
| $$ Fecha\:Nacimiento$$     | $$DATE \:NOT \:NULL$$        | 
| $$ Domicilio$$     | $$VARCHAR(50) \:NOT \:NULL  $$            | 
| $$ Telefono$$     | $$INT \:NOT\: NULL  $$            | 

_Esta tabla contiene los datos de los médicos que prestan su servicio a distintos centros médicos._



<br>
</br>


| $$ \textbf{Tabla: Centro Medico }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Centro$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Nombre$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |
| $$ Dirección$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 
| $$ Teléfono$$     | $$INT \:NOT \:NULL$$        | 
| $$ Cod\:Postal$$     | $$INT \:NOT \:NULL$$        | 
| $$ Email$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 
| $$ Especialidad\:Principal$$     | $$VARCHAR(50) \:NOT \:NULL  $$         | 

<br>
</br>


| $$ \textbf{Tabla: Consulta }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Consulta$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Consulta$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |
| $$ Diagnostico$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |


_Esta tabla contiene los datos de las consultas de los afiliados y los diagnosticos posterior a la consulta._

<br>
</br>


| $$ \textbf{Tabla: Turnos }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Turno$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$         | 
| $$ Fecha$$     | $$DATE \:NOT \:NULL  $$         |
| $$ Id\: Medico$$     | $$INT \:NOT\: NULL\: FOREIGN \:KEY $$            | 
| $$ Id\: Afiliado$$     | $$INT \:NOT\: NULL\: FOREIGN \:KEY $$            | 
| $$ Id\: Consulta$$     | $$INT \:NOT\: NULL\: FOREIGN \:KEY $$            | 
| $$ Id\:Centro$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 



_Esta tabla contiene los datos del turno. Se conecta con varias tablas, entre ellas la de consulta. Una vez registrado el turno en la base de datos y luego de la consulta se completan los valores en la tabla consulta con el diagnostico final._


<br>
</br>

| $$ \textbf{Tabla: Proveedor }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Proveedor$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$  | 
| $$ Nombre$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |
| $$ Telefono$$     | $$INT \:NOT\: NULL\: FOREIGN \:KEY $$            | 
| $$ Cuit$$     | $$INT \:NOT\: NULL\: FOREIGN \:KEY $$            | 
| $$ Mail$$     | $$VARCHAR(50) \:NOT \:NULL  $$            | 

_La tabla contiene todos los datos de los proveedores que se van dando de alta. No tiene muchos movimientos en general._

<br>
</br>



| $$ \textbf{Tabla: Tipo Insumo }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Tipo\:Insumo$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$  | 
| $$ Tipo\:Insumo$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |


_Tabla que contiene datos sobre el tipo de insumo que compran los centros medicos. No tiene muchos movimientos._

<br>
</br>


| $$ \textbf{Tabla: Insumos }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Insumo$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$  | 
| $$ Nombre$$     | $$VARCHAR(50) \:NOT \:NULL  $$         |
| $$ Id\:Centro$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Tipo\:Insumo$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Proveedor$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 


_Esta tabla contiene los datos de cada uno de los insumos._

<br>
</br>



| $$ \textbf{Tabla: Centro Medico Insumos }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Centro\:Medico\:Insumos$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$  | 
| $$ Id\:Centro$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Insumo$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 


_Tabla que conecta de muchos a muchos los insumos con los centros medicos._

<br>
</br>



| $$ \textbf{Tabla: Pagos }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Pagos$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$  | 
| $$ Fecha\:Transaccion$$     |   $$DATE\:NOT\:NULL$$  | 
| $$ Importe$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Medio\:Operacion$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Proveedor$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 


_Tabla que registra todos los pagos de todos los centros médicos._

<br>
</br>


| $$ \textbf{Tabla: Cobros }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Cobros$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$ | 
| $$ Fecha\:Transaccion$$     |   $$DATE\:NOT\:NULL$$  | 
| $$ Importe$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Medio\:Operacion$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 
| $$ Id\:Afiliado$$     |   $$INT \:NOT\: NULL\: FOREIGN \:KEY $$         | 


_Tabla que registra todos los cobros de todos los centros médicos._

<br>
</br>


| $$ \textbf{Tabla: Medio Operacion }$$ |
|$$ \textbf{Atributos}$$ | $$ \textbf{Descripcion}$$ | 
|-------|------------|
| $$ Id\:Medio\:Operacion$$     |   $$INT \:NOT\: NULL\: PRIMARY \:KEY\: AUTO\:INCREMENT$$ | 
| $$ Tipo\:Medio\:Operacion$$     |   $$VARCHAR(50) \:NOT \:NULL   $$         | 


_Tabla que registra todos medios financieros de pagos: *Tarjeta de Debito, Crédito, Efectivo y Transferencias*._
</b>
<br>
</br>



<div style="text-align: left" class="toc-box">
# 5 - Diagrama Entidad de Relacion
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>


<br>
</br>

<b>
Un diagrama entidad-relación, también conocido como modelo entidad relación o ERD, es un tipo de diagrama de flujo que ilustra cómo las "entidades", como personas, objetos o conceptos, se relacionan entre sí dentro de un sistema. Los diagramas ER se usan a menudo para diseñar o depurar bases de datos relacionales en los campos de ingeniería de software, sistemas de información empresarial, educación e investigación.

En <b>[este link](https://app.diagrams.net/)</b> se puede elaborar un DER preliminar para luego trabajarlo en una base de datos.


![](DER.png)

<br>
</br>

Luego de crear las tablas en My Sql podemos ver el Reverse Engineer. 

La ingeniería inversa o retroingeniería es el proceso llevado a cabo con el objetivo de obtener información o un diseño a partir de un producto, con el fin de determinar cuáles son sus componentes y de qué manera interactúan entre sí y cuál fue el proceso de fabricación. 


![](Imagenes/reverseoptions.png)

La siguiente imagen representa el Reverse Engineer de la base de datos creada:

</b>
![](REVERSE.png)

<br>
</br>

<div style="text-align: left" class="toc-box">
# 6 - Codigo MySql desde Python
</div>

<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>


<br>
</br>



<b>
En el siguiente enlace se encuentra el código para crear la base de datos desde Python:

<br>
</br>

```{r, echo=FALSE, out.width="40%", fig.align='center'}
knitr::include_graphics("Imagenes/github.jpg")
```

<br>
</br>


<div style="text-align: center" >
[Link Github Codigo](https://github.com/MGaloto/mysql_creando_database)
</div>



<br>
</br>

<div style="text-align: left" class="toc-box">
# 7 - Inserción de datos
</div>

<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>


<br>
</br>


**_Metodologia utilizada:_**
<b>
Los valores en cada una de las tablas se insertaron desde archivos .csv.

Los archivos son los siguientes:



![](imagenes/archivos.png)

  
_Cada una de las tablas contiene 10 observaciones_


_Ejemplo tabla afiliados:_


![](imagenes/afiliado.png)


A continuación se adjuntan scripts de los pasos para importar los datos y MySql final:

![](imagenes/import.png){width=70%}


![](imagenes/script_medico.png){width=70%}



![](imagenes/base_datos.png)

</b>

<div style="text-align: left" class="toc-box">
# 8 - Vistas
</div>



<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>



<b>
**_A continuación se adjuntan los scripts de las vistas_**

_El código SQL de las vistas se encuentra en el siguiente link:_ [Github Codigo](https://github.com/MGaloto/mysql_creando_database/blob/main/database.py)


<ul>

<br>
</br>

**_1) Vista 1:_**


_Consulta y Diagnostico por Afiliado_

_Esta vista permite guardarnos en una tabla aparte todos los turnos solicitados por los afiliados dados de alta en el sistema. Nos sirve para estar actualizados de los ultimos turnos ya que esta ordenada por fecha._


![](imagenes/vista1.png)
<br>
</br>
<br>
</br>



**_2) Vista 2_**

_Que medico atendió a cada paciente:_

_Esta vista creada nos sirve para visualizar forma rapida mediante su consulta sobre que medicos atendieron a que paciente en determinada fecha._

![](imagenes/vista2.png)
<br>
</br>
<br>
</br>

**_3) Vista 3_**

_Que medico atiende en cada centro medico:_

_Esta vista permite que podamos visualizar de forma rapida que medicos atienden en los centros medicos._

![](imagenes/vista3.png)


<br>
</br>
<br>
</br>


</ul>


</b>

<div style="text-align: left" class="toc-box">
# 9 - Funciones
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>


<br>
</br>





<b>

Por definición es importante indicar que una función es un conjunto de instrucciones SQL que realizan una tarea específica de manera automática. Una función acepta entradas en forma de parámetros y devuelve un valor.


**_A continuación se adjuntan los scripts de las funcioness_**


<ul>

**_1) Función 1:_**


_Función donde ingresamos un CHAR y nos devuelve un NUMERIC_

_Ingresamos el diagnostico y nos regresa el porcentaje de pacientes con el diagnostico ingresado de nuestra base de datos_

_En la parte inferior de la imagen adjunta se puede ver el resultado de la función una vez ingresado un CHAR._

![](imagenes/funcion1.png)
<br>
</br>
<br>
</br>


**_2) Función 2:_**


_Función que no requiere un valor de entrada._

_Esta funcion nos calcula automaticamente la diferencia entre ingresos y egresos de todos los centros medicos._

_En la parte inferior de la imagen adjunta se puede ver el resultado de la función una vez ingresado un CHAR._

![](imagenes/funcion2.png)
<br>
</br>
<br>
</br>

</ul>

</b>

<div style="text-align: left" class="toc-box">
# 10 - Stored Procedures
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>


<br>
</br>




<b>
Un stored procedure es un programa (o procedimiento) almacenado físicamente en una base de datos. Su implementación varía de un gestor de bases de datos a otro. La ventaja de un procedimiento almacenado es que al ser ejecutado, en respuesta a una petición de usuario, es ejecutado directamente en el motor de bases de datos, el cual usualmente corre en un servidor separado. Como tal, posee acceso directo a los datos que necesita manipular y sólo necesita enviar sus resultados de regreso al usuario, deshaciéndose de la sobrecarga resultante de comunicar grandes cantidades de datos salientes y entrantes.


**_A continuación se adjuntan los scripts de los Stored Procedures_**

<ul>


**_1) Stored Procedure 1:_**


_En el siguiente Stored Procedure insertamos valores en la tabla turno con el ID creado anteriormente en la tabla consulta._


![](imagenes/sp1.png)
<br>
</br>
<br>
</br>


**_2) Stored Procedure 2:_**


_El siguiente Stored Procedure ejecuta un comando que nos permite ordenar la tabla que queramos por una variable._


![](imagenes/sp2.png)
<br>
</br>
<br>
</br>

</ul>
</b>


<div style="text-align: left" class="toc-box">
# 11 - Triggers
</div>


<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>

<br>
</br>



<b>

Un disparador o trigger es una funcionalidad que la base de datos ejecuta de forma automática cuando se realiza una operación de tipo Insert, Update o Delete en una tabla o vista, o cuando se ejecuta una consulta SQL sobre una tabla o vista.

Un trigger no puede existir sin una tabla asignada, podemos crear muchos triggers para una tabla. 

Cuando un evento ya sea de tipo Insert, Update o Delete se realiza en una tabla que contiene uno o varios triggers, en la tabla que creamos que comienza con logs se ejecuta tambien ese evento modificando la tabla. Hay dos comandos que podemos utilizar, el Before y el After, con el primero cuando insertamos datos en la tabla principal primero ingresaran al triger y luego a la tabla principal, con el After ocurre todo lo contrario.

**_A continuación se adjuntan los scripts de los Triggers_**


<ul>

**_1) Triggers 1:_**


_En el siguiente Trigger se crea un log para la tabla afiliados y luego de insertar los datos en la tabla afiliados van a parar al trigger creado._



![](imagenes/triggeraft1.png)
<br>
</br>
<br>
</br>
_Lo contrario sucede con la próxima imagen que es un Before._

![](imagenes/triggerbef1.png)

<br>
</br>
<br>
</br>

**_2) Triggers 2:_**


_En el siguiente Trigger se crea un log para la tabla consulta y antes de que se completen los nuevos valores para la tabla se completan en la tabla de logs con fecha, usuario, id y tipo de operación._

_Lo contrario sucede con la próxima imagen que es un Before._


![](imagenes/triggeraft2.png)


<br>
</br>
<br>
</br>

_Lo contrario sucede con la próxima imagen que es un Before._

![](imagenes/triggerbef2.png)

<br>
</br>
<br>
</br>


</ul>

</b>








<div style="text-align: left" class="toc-box">
# 12 - Permisos
</div>







<div style="text-align: left" class="toc-box">
 <a href="#top">Volver al Inicio</a>
</div>

<br>
</br>



<b>

Sentencias GRANT y REVOKE

Utilizando la sentencia GRANT podemos dar permisos al usuario creado para que pueda hacer los siguientes comandos sobre la base de datos o una tabla en particular: SELECT, INSERT, UPDATE y DELETE.

Con la sentencia REVOKE le quitamos permisos al usuario.


**_A continuación se adjuntan los scripts de los Usuarios creados y las sentencias_**

<ul>

_Creamos el usuario_uno y el usuario_dos donde al primero le damos permiso con la sentencia GRANT para que solo pueda hacer comandos SELECT. Al usuario_dos le damos permiso para que pueda alterar, seleccionar e insertar datos._

_Con la sentencia REVOKE le quitamos a ambos usuarios la posibilidad de eliminar registros._


![](imagenes/user.png)
<br>
</br>
<br>
</br>


_SHOW GRANTS para el usuario_uno._


_Podemos ver que solo tiene permiso para la sentencia SELECT en la base de datos._

![](imagenes/user_1.png)


_SHOW GRANTS para el usuario_dos._

_Podemos ver que tiene permiso para la sentencia SELECT, INSERT y ALTER en la base de datos._

![](imagenes/user_2.png)

</b>


